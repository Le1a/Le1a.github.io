(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[20753],{87170:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/result",function(){return r(35857)}])},58979:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSG:function(){return h},default:function(){return g}});var o=r(85893),l=r(67294),n=()=>{let[e,t]=(0,l.useState)(""),[r,n]=(0,l.useState)(!1),a=()=>{n(!1),t("")};return{showNotification:e=>{t(e),n(!0),setTimeout(()=>{a()},3e3)},closeNotification:a,Notification:()=>(0,o.jsx)("div",{className:"notification fixed left-0 w-full px-2 z-20 bottom-14",children:(0,o.jsxs)("div",{className:" ".concat(r&&e?"opacity-100 ":"invisible opacity-0 bottom-0"," transition-opacity duration-200 \n           max-w-3xl mx-auto bg-green-500 flex items-center justify-between px-4 py-2 text-white rounded-lg shadow-lg"),children:[e,(0,o.jsx)("button",{onClick:a,className:"ml-4 p-2 cursor-pointer bg-transparent text-white border-none",children:(0,o.jsx)("i",{className:"fas fa-times"})})]})})}},a=r(69325),i=r(93348),s=r(78174),u=r(11163);let d=e=>{document.querySelectorAll("a.catalog-item").forEach(t=>{e?(t.style.pointerEvents="none",t.style.opacity="0.5"):(t.style.pointerEvents="auto",t.style.opacity="1")})};var c=()=>{let e=(0,u.useRouter)(),t=(0,a.JA)("OPEN_WRITE_QRCODE","请配置公众号二维码"),r=(0,a.JA)("OPEN_WRITE_BLOG_ID"),n=(0,a.JA)("OPEN_WRITE_NAME","请配置公众号名"),c=(0,a.JA)("OPEN_WRITE_KEYWORD","请配置公众号关键词"),f=(0,a.JA)("OPEN_WRITE_BTN_TEXT","原创不易，完成人机检测，阅读全文"),p=(0,a.JA)("OPEN_WRITE_VALIDITY_DURATION",1),v=(0,a.JA)("OPEN_WRITE_WHITE_LIST",""),{isLoaded:_,isSignedIn:w}=(0,i.O)(),m=async()=>{try{var e;await (0,s.loadExternalResource)("https://readmore.openwrite.cn/js/readmore-2.0.js","js");let o=null===(e=window)||void 0===e?void 0:e.BTWPlugin;if(o){let e=new o;window.btw=e,e.init({qrcode:t,id:"article-wrapper",name:n,btnText:f,keyword:c,blogId:r,cookieAge:p});let l=setInterval(()=>{let e=document.getElementById("read-more-wrap"),t=document.getElementById("article-wrapper");!e&&t&&(d(!1),t.style.height="auto",clearInterval(l))},1e3);return()=>clearInterval(l)}}catch(e){console.error("OpenWrite 加载异常",e)}};return(0,l.useEffect)(()=>{if(!function(e,t){if(!e||!t)return!0;let r=e.replace(/\?.*$/,"").replace(/.*\/([^/]+)(?:\.html)?$/,"$1"),o=t.includes(r);return o&&console.log("OpenWrite白名单",r),o}(e.asPath,v)){if(w){console.log("用户已登录");return}s.isBrowser&&r&&!w&&(d(!0),document.getElementById("read-more-wrap")||m())}},[_,e]),(0,o.jsx)(o.Fragment,{})},f=r(58622);let p={header:0,sub_header:1,sub_sub_header:2},v=(e,t)=>{var r;let o=function e(t,r,o){if(o||(o=[]),!t)return o;for(let i of t){var l,n,a;let t=null===(l=r.block[i])||void 0===l?void 0:l.value;if(!t)continue;let{type:s}=t;s.indexOf("header")>=0&&!o.find(e=>e.id===i)&&o.push({id:i,type:s,text:(0,f.FB)(null===(a=t.properties)||void 0===a?void 0:a.title),indentLevel:p[s]}),(null===(n=t.content)||void 0===n?void 0:n.length)>0&&e(t.content,r,o)}return o}(null!==(r=e.content)&&void 0!==r?r:[],t),l=[{actual:-1,effective:-1}];for(let e of o){let{indentLevel:t}=e;for(;;){let{actual:r,effective:o}=l[l.length-1];if(t>r)e.indentLevel=o+1,l.push({actual:t,effective:e.indentLevel});else if(t===r){e.indentLevel=o;break}else l.pop()}}return o},_=e=>{let t=new URL(e,s.isBrowser?window.location.origin:""),r=Object.fromEntries(t.searchParams.entries());r.password&&localStorage.setItem("password_default",r.password);let o=t.pathname,l=localStorage.getItem("password_"+o),n=localStorage.getItem("password_default");return[r.password,l,n].filter(Boolean)};var w=r(31123),m=r(88495),E=r.n(m),h=!0,g=e=>{let{post:t}=e,r=(0,u.useRouter)(),{locale:s}=(0,i.O)(),[d,f]=(0,l.useState)((null==t?void 0:t.password)&&(null==t?void 0:t.password)!==""),{showNotification:p,Notification:m}=n(),h=e=>{if(!t)return!1;let o=E()((null==t?void 0:t.slug)+e);return!!e&&o===(null==t?void 0:t.password)&&(f(!1),localStorage.setItem("password_"+r.asPath,e),p(s.COMMON.ARTICLE_UNLOCK_TIPS),!0)};(0,l.useEffect)(()=>{(null==t?void 0:t.password)&&(null==t?void 0:t.password)!==""?f(!0):f(!1);let e=_(r.asPath);if(e.length>0){for(let t of e)if(h(t))break}},[t]),(0,l.useEffect)(()=>{var e;!d&&(null==t?void 0:null===(e=t.blockMap)||void 0===e?void 0:e.block)&&(t.content=Object.keys(t.blockMap.block).filter(e=>{var r,o;return(null===(o=t.blockMap.block[e])||void 0===o?void 0:null===(r=o.value)||void 0===r?void 0:r.parent_id)===t.id}),t.toc=v(t,t.blockMap))},[r,d]),e={...e,lock:d,setLock:f,validPassword:h};let g=(0,w.getLayoutByTheme)({theme:(0,a.JA)("THEME"),router:(0,u.useRouter)()});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g,{...e}),(null==t?void 0:t.password)&&(null==t?void 0:t.password)!==""&&!d&&(0,o.jsx)(m,{}),(0,o.jsx)(c,{})]})}},35857:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSG:function(){return a}});var o=r(85893),l=r(11163),n=r(58979),a=!0;t.default=e=>{var t;let r=(0,l.useRouter)();return(0,o.jsx)(n.default,{...e,msg:null==r?void 0:null===(t=r.query)||void 0===t?void 0:t.msg,title:"授权结果"})}}},function(e){e.O(0,[92888,49774,40179],function(){return e(e.s=87170)}),_N_E=e.O()}]);