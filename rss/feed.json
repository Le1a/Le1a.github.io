{
    "version": "https://jsonfeed.org/version/1",
    "title": "Le1a的菜园坝 ",
    "home_page_url": "https://le1a.github.io/",
    "description": "一个NotionNext搭建的博客",
    "author": {
        "name": "Le1a",
        "url": "https://le1a.github.io"
    },
    "items": [
        {
            "content_html": "<div id=\"notion-article\" class=\"mx-auto overflow-hidden \"><main class=\"notion light-mode notion-page notion-block-2ae7c0311dd680f9b3b2dfaf8b7cc13e\"><div class=\"notion-viewport\"></div><div class=\"notion-collection-page-properties\"></div><h2 class=\"notion-h notion-h1 notion-h-indent-0 notion-block-2ae7c0311dd680b28abae1627bc83879\" data-id=\"2ae7c0311dd680b28abae1627bc83879\"><span><div id=\"2ae7c0311dd680b28abae1627bc83879\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2ae7c0311dd680b28abae1627bc83879\" title=\"前言\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">前言</span></span></h2><div class=\"notion-text notion-block-2ae7c0311dd680858dddecae280b41f8\">今天看到赛博发了一篇TongWeb的反序列化，TongWeb好久没爆洞了，赶紧夺开代码和环境看一眼 。根据官方通告可得知存在漏洞的是ejbserver接口，赶紧把环境搭起来。安装环境我放个链接，密码联系我获取吧</div><blockquote class=\"notion-quote notion-block-2ae7c0311dd680c2a329f5bb3c389eb9\"><div>飞牛分享【TongWeb7.0.4.6_Enterprise_Linux.zip】，点击链接下载文件，App打开可转存到NAS：https://s.fnnas.net/s/9466bdc77b30401289</div></blockquote><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ae7c0311dd680c0b454e776a4424c0c\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Ab9c0dd0d-41ae-4f3f-b41d-834ea6d71023%3A8f189d9c-bd89-4862-b401-869a2d8a3298.png?table=block&amp;id=2ae7c031-1dd6-80c0-b454-e776a4424c0c&amp;t=2ae7c031-1dd6-80c0-b454-e776a4424c0c\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><h2 class=\"notion-h notion-h1 notion-h-indent-0 notion-block-2ae7c0311dd680ada5f2c0b6cef354e4\" data-id=\"2ae7c0311dd680ada5f2c0b6cef354e4\"><span><div id=\"2ae7c0311dd680ada5f2c0b6cef354e4\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2ae7c0311dd680ada5f2c0b6cef354e4\" title=\"第一Sink点\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">第一Sink点</span></span></h2><div class=\"notion-text notion-block-2ae7c0311dd6803a821ee8512d19b17c\">根据补丁可以定位到com/tongweb/tongejb/server/httpd/ServerServlet.class</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ae7c0311dd6809ca2cef0b984b6ecb0\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:479px;max-width:100%;flex-direction:column\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Acfb105ed-f380-48e3-a182-693076240ad9%3Ab9ecdb1e-cac2-4996-8f6d-f3465e0df1e8.png?table=block&amp;id=2ae7c031-1dd6-809c-a2ce-f0b984b6ecb0&amp;t=2ae7c031-1dd6-809c-a2ce-f0b984b6ecb0\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ae7c0311dd6804bac81f2eb3d623daf\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:679px;max-width:100%;flex-direction:column\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A9aa18b43-532c-4183-9d96-492c1eb3c87e%3A2c55184d-c071-4075-80cd-b8fbdb3ce03e.png?table=block&amp;id=2ae7c031-1dd6-804b-ac81-f2eb3d623daf&amp;t=2ae7c031-1dd6-804b-ac81-f2eb3d623daf\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-blank notion-block-2ae7c0311dd680c080a0e3ee9f49d560\"> </div><div class=\"notion-text notion-block-2ae7c0311dd680adb44ec9ffcf866da7\">跟进this.ejbServer.service(in, out);</div><div class=\"notion-text notion-block-2ae7c0311dd680b38e19d7d4d60a94a4\">继续跟进this.server.service(inputStream, outputStream);</div><div class=\"notion-text notion-block-2ae7c0311dd6804f86d9d5127134116e\">这里构建了ProtocolMetaData和ServerMetaData，会从输入流中读取</div><div class=\"notion-text notion-block-2ae7c0311dd6806bbca4c42b8470356e\">这里先关注ProtocolMetaData#readExternal()</div><div class=\"notion-text notion-block-2ae7c0311dd680a4a3d9c45accfcfc55\">读取前8字节，然后正则匹配协议头，如果不符合则抛出异常，所以我们需要</div><div class=\"notion-text notion-block-2ae7c0311dd680ae96b2cde987e76db1\">接下来看看ServerMetaData#readExternal()，这里采用了ois = new EjbObjectInputStream(cis);开始读取对象流了，并且序列化了</div><div class=\"notion-text notion-block-2ae7c0311dd68005b86fc0d1a5ae9691\">所以如下构造即可：</div><div class=\"notion-text notion-block-2ae7c0311dd6803eb60adda5957b341b\">这里用URLDNS链验证：</div><h2 class=\"notion-h notion-h1 notion-h-indent-0 notion-block-2ae7c0311dd6805ebb56f5ca9a9c4492\" data-id=\"2ae7c0311dd6805ebb56f5ca9a9c4492\"><span><div id=\"2ae7c0311dd6805ebb56f5ca9a9c4492\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2ae7c0311dd6805ebb56f5ca9a9c4492\" title=\"第二Sink点\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">第二Sink点</span></span></h2><div class=\"notion-text notion-block-2ae7c0311dd680fca93cebc5a27ec98f\">除了这里有readObject以外，在后面还有一个，这也就是为什么各家厂商复现的截图，有的响应是空的，有的响应是带序列化数据的。</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ae7c0311dd680b88da2f47b633e065a\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A38e5562a-c2e8-478d-a8a9-f36491d174e8%3A454d692d-9b71-43b4-a23c-21539d1d399e.png?table=block&amp;id=2ae7c031-1dd6-80b8-8da2-f47b633e065a&amp;t=2ae7c031-1dd6-80b8-8da2-f47b633e065a\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-blank notion-block-2ae7c0311dd680c19908ea0231a21a1a\"> </div><div class=\"notion-text notion-block-2ae7c0311dd68024ab27e1305d9c9a78\">这里需要写入一个requestType为oos.writeByte((byte)0);只要不是-1就行</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ae7c0311dd680f88f57e3e5c3337473\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A9af6dea3-1c6e-42f3-8122-c50597c56ece%3Ae27d2822-b08c-4dfb-9062-45760d65f6d5.png?table=block&amp;id=2ae7c031-1dd6-80f8-8f57-e3e5c3337473&amp;t=2ae7c031-1dd6-80f8-8f57-e3e5c3337473\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-blank notion-block-2ae7c0311dd680a195e5e8d0520df481\"> </div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ae7c0311dd68083aa62cd78b7873613\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:375px;max-width:100%;flex-direction:column\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A7d9dbcf8-a6ba-46c4-b69e-f63fef94f338%3Acc4371af-d960-48fa-ade0-bd34be463304.png?table=block&amp;id=2ae7c031-1dd6-8083-aa62-cd78b7873613&amp;t=2ae7c031-1dd6-8083-aa62-cd78b7873613\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ae7c0311dd6807c9edae68846e46a9b\">这里需要requestType满足EJB_REQUEST，所以再写一个oos.writeByte((byte)0);</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ae7c0311dd680baad53ee4ab1c62bb6\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:463px;max-width:100%;flex-direction:column\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A6a11a363-85b3-439f-acee-adfeda7f1608%3A459fdbdf-d740-4bcb-b661-7b76b6c05cd2.png?table=block&amp;id=2ae7c031-1dd6-80ba-ad53-ee4ab1c62bb6&amp;t=2ae7c031-1dd6-80ba-ad53-ee4ab1c62bb6\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-blank notion-block-2ae7c0311dd680c79807df92ec05fa1a\"> </div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ae7c0311dd680d4a8b0d413d10d12b2\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:604px;max-width:100%;flex-direction:column\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A5374dff9-21dc-4808-9a49-eedf23c57f53%3A6872654b-a993-4550-8ca7-57edb70d9f9f.png?table=block&amp;id=2ae7c031-1dd6-80d4-a8b0-d413d10d12b2&amp;t=2ae7c031-1dd6-80d4-a8b0-d413d10d12b2\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ae7c0311dd6805d8566db97e9970a91\">需要注意：如果我们要触发第二个sink的话，刚才的URI[]对象就要正常构造一个</div><div class=\"notion-text notion-block-2ae7c0311dd680b8ae84da0053f0c2ae\">继续跟进this.processEjbRequest(ois, clientProtocol);</div><div class=\"notion-text notion-block-2ae7c0311dd680e681fde42b2c38a3f8\">这里又获取了一个值，得保证我们写入一个存在的值，这里随便写个23吧</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ae7c0311dd6803289a6cfa4aa6ef0b7\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:691px;max-width:100%;flex-direction:column\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Aa4bce547-cd91-4014-8ddf-01d0e3ec6c38%3Ac0dd3707-f856-4b27-931d-db4f169300a4.png?table=block&amp;id=2ae7c031-1dd6-8032-89a6-cfa4aa6ef0b7&amp;t=2ae7c031-1dd6-8032-89a6-cfa4aa6ef0b7\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2ae7c0311dd6805c8d3af3bcfeab8b31\">后面这里this.deploymentId = (String) in.readObject();再次反序列化了，所以构造下面这个PoC就能打这个sink了</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2ae7c0311dd68063bf60c633b4c79888\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Ac1aa2cb6-da30-40ad-a73c-47e091ccf2ca%3A1a412f47-e784-4f79-94cf-d2df4c7d9f15.png?table=block&amp;id=2ae7c031-1dd6-8063-bf60-c633b4c79888&amp;t=2ae7c031-1dd6-8063-bf60-c633b4c79888\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><h2 class=\"notion-h notion-h1 notion-h-indent-0 notion-block-2ae7c0311dd680eebf7ae73d9fc27798\" data-id=\"2ae7c0311dd680eebf7ae73d9fc27798\"><span><div id=\"2ae7c0311dd680eebf7ae73d9fc27798\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2ae7c0311dd680eebf7ae73d9fc27798\" title=\"如何RCE？\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">如何RCE？</span></span></h2><div class=\"notion-text notion-block-2ae7c0311dd680ff862ce5248bf65e30\">学习Y4的链子</div><div class=\"notion-text notion-block-2ae7c0311dd68077accbcad06047f79b\">首先HashTable可以触发HashMap.equals()，下面来回顾一下</div><div class=\"notion-text notion-block-2ae7c0311dd68030b4befd486f388735\">跟进reconstitutionPut(table, key, value);</div><div class=\"notion-text notion-block-2ae7c0311dd6805e9b9dfd9f68bef705\">当HashTable存放HashMap，并且HashMap存放的值为yy和zZ的时候，hashCode值相同。这样就能进入这个for循环，进而调用key.equals()</div><div class=\"notion-text notion-block-2ae7c0311dd6802fb8eae80a626549ee\">这里会调用m.get(key)。</div><div class=\"notion-text notion-block-2ae7c0311dd68082987cf33550c9b929\">根据https://xz.aliyun.com/news/14169文章提到的javax.swing.UIDefaults.TextAndMnemonicHashMap</div><div class=\"notion-text notion-block-2ae7c0311dd680569777d161aaa350f9\">当HashCode相同时，触发TextAndMnemonicHashMap.equals() -&gt; TextAndMnemonicHashMap.get()</div><div class=\"notion-text notion-block-2ae7c0311dd680768d01ca8fe7babfbc\">这里调用key.toString(); 如果TextAndMnemonicHashMap存放的key是com.tongweb.xbean.naming.context.ContextUtil$ReadOnlyBinding</div><div class=\"notion-text notion-block-2ae7c0311dd680249efacd0d3a443682\">那么就会触发ReadOnlyBinding.toString()，ReadOnlyBinding没重写toString()，那么调用父类的Binding.toString()</div><div class=\"notion-text notion-block-2ae7c0311dd680409ad0c38c4919d0fe\">这里调用了getObject()</div><ol start=\"1\" class=\"notion-list notion-list-numbered notion-block-2ae7c0311dd68052bffcf4e01016e628\"><li>虽然代码是写在父类 Binding 里的，但 this.getObject() 这个调用遵循 Java 的多态（Polymorphism）规则。</li></ol><ol start=\"2\" class=\"notion-list notion-list-numbered notion-block-2ae7c0311dd6807abd74c26704ffe41a\"><li>this 关键字指向的是当前运行时的实际对象。在我们的场景中，this 就是我们创建的那个 ReadOnlyBinding 的实例。</li></ol><ol start=\"3\" class=\"notion-list notion-list-numbered notion-block-2ae7c0311dd680a98717f978ed8bb551\"><li>JVM 会在运行时决定调用哪个 getObject() 方法。它会先检查 ReadOnlyBinding 是否重写了 getObject() 方法。</li></ol><ol start=\"4\" class=\"notion-list notion-list-numbered notion-block-2ae7c0311dd68095bfc8c17c0f552bac\"><li>我们检查源码发现，ReadOnlyBinding 确实重写了 getObject() 方法：</li></ol><ol start=\"1\" class=\"notion-list notion-list-numbered notion-block-2ae7c0311dd680b9aab0f41d5bb9a832\"><li>因此，父类 Binding.toString() 中的 this.getObject() 调用，最终执行的是子类 ReadOnlyBinding 重写后的版本。</li></ol><div class=\"notion-text notion-block-2ae7c0311dd680b6a74bdbd6c2e3f5b6\">跟进ReadOnlyBinding.getObject()</div><div class=\"notion-text notion-block-2ae7c0311dd680ce87b6d42e49fb6bab\">ContextUtil.resolve 方法本质上是一个 JNDI (Java Naming and Directory Interface) 对象解析器。它的任务是根据一个“引用”（Reference）来查找并获取真正的对象。</div><div class=\"notion-text notion-block-2ae7c0311dd6806d8596e660dac9cad0\">在<code class=\"notion-inline-code\">NamingManager.getObjectInstance(reference, parsedName, nameCtx,nameCtx.getEnvironment());</code>触发JNDI注入</div><div class=\"notion-text notion-block-2ae7c0311dd6805990e5e60540e8fb81\">这里就引入了一个经典JNDI高版本不出网利用——https://tttang.com/archive/1405/</div><div class=\"notion-text notion-block-2ae7c0311dd6806f8fa9c6f2e8d703e5\">利用<code class=\"notion-inline-code\">org.apache.naming.factory.BeanFactory</code> 打 <code class=\"notion-inline-code\">javax.el.ELProcessor#eval</code></div><div class=\"notion-text notion-block-2ae7c0311dd68086af67dc3fed10eff4\">核心原理是：<code class=\"notion-inline-code\">forceString</code>是<code class=\"notion-inline-code\">BeanFactory</code>提供的一个特殊指令。它允许我们强制将一个属性名映射到任意一个方法名。通过<code class=\"notion-inline-code\">forceString</code>指令，我们可以设置<code class=\"notion-inline-code\">ref.add(new StringRefAddr(&quot;forceString&quot;, &quot;x=eval&quot;));</code>将属性 &quot;x&quot; 映射到方法 &quot;eval&quot;，当为x赋值时，不会调用setX，而是调用eval，并把值作为参数。</div><blockquote class=\"notion-quote notion-block-2ae7c0311dd680d6bc61fb97f8683001\"><div><b>RefAddr 是干嘛的？</b></div><div class=\"notion-text notion-block-2ae7c0311dd680ae99f3da9cbb0298dc\">简单来说，RefAddr 就像一个“键值对”，它存放在 Reference 这个“蓝图”里，用来提供创建对象所需的额外信息。</div><div class=\"notion-text notion-block-2ae7c0311dd680adbd48f8c00af77c95\">RefAddr 有两个核心属性：</div><ul class=\"notion-list notion-list-disc notion-block-2ae7c0311dd6803fb6f0c51ee4f0ad8f\"><li>type (String): 键，或者可以理解为“属性名”。</li></ul><ul class=\"notion-list notion-list-disc notion-block-2ae7c0311dd680f68159f9639b7c98bd\"><li>content (Object): 值，或者可以理解为“属性值”。</li></ul><div class=\"notion-text notion-block-2ae7c0311dd680e6ae04e92ebf6787db\">StringRefAddr 是它的一个常用子类，专门用来存放字符串类型的值。</div><div class=\"notion-text notion-block-2ae7c0311dd6805082b2c9ec7fdc3c77\">你可以把 Reference 想象成一个完整的“购物清单”，而每一个 RefAddr 就是清单上的一行项目。</div><div class=\"notion-text notion-block-2ae7c0311dd6809e8d28fac6b3fc8ad6\">例如，要配置一个数据库连接池，清单上可能会有：</div><ul class=\"notion-list notion-list-disc notion-block-2ae7c0311dd6808c8eaff4ef627de426\"><li>RefAddr(type=&quot;username&quot;, content=&quot;admin&quot;)</li></ul><ul class=\"notion-list notion-list-disc notion-block-2ae7c0311dd68007aa14ec000aee4104\"><li>RefAddr(type=&quot;password&quot;, content=&quot;password123&quot;)</li></ul><ul class=\"notion-list notion-list-disc notion-block-2ae7c0311dd68086a6d4dce092ac3fe0\"><li>RefAddr(type=&quot;url&quot;, content=&quot;jdbc:mysql://localhost:3306/mydb&quot;)</li></ul><div class=\"notion-text notion-block-2ae7c0311dd6805aa2e2d9ac7b9d55d0\">JNDI触发时，会处理 ref 里的 RefAddr</div><div class=\"notion-text notion-block-2ae7c0311dd680b2a7b6fc3fd2bcc70a\">当 BeanFactory 拿到 Reference 这个蓝图后，它的主要工作就是：</div><div class=\"notion-text notion-block-2ae7c0311dd680ca9695e7d6601f320d\">1、根据 className 创建一个空的对象实例（比如一个 ELProcessor 实例）。</div><div class=\"notion-text notion-block-2ae7c0311dd680318f77fa3a012d8f54\">2、遍历 Reference 里的所有 RefAddr，然后根据这些“键值对”来配置和操作这个空对象。</div></blockquote><div class=\"notion-blank notion-block-2ae7c0311dd680db974ff7a42ef85f5b\"> </div></main></div>",
            "url": "https://le1a.github.io/article/2ae7c031-1dd6-80f9-b3b2-dfaf8b7cc13e",
            "title": "TongWeb ejbserver 反序列化漏洞分析",
            "date_modified": "2025-11-13T00:00:00.000Z"
        },
        {
            "content_html": "<div id=\"notion-article\" class=\"mx-auto overflow-hidden \"><main class=\"notion light-mode notion-page notion-block-2737c0311dd68018a702ef94ca1acb04\"><div class=\"notion-viewport\"></div><div class=\"notion-collection-page-properties\"></div><div class=\"notion-text notion-block-2737c0311dd680b0ac6ff609515e06cd\">文章首发自：<a target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link\" href=\"https://forum.butian.net/share/2686\">奇安信攻防社区</a></div><div class=\"notion-text notion-block-2737c0311dd68000a4ebdc60a233a846\">漏洞点位于/api/jolokia接口，通过webapps/api/WEB-INF/web.xml可得知对应的Servlet是<code class=\"notion-inline-code\">org.jolokia.http.AgentServlet</code></div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd680d4a4a8d16bb5eee913\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:623px;max-width:100%;flex-direction:column\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Aa171be5f-2814-48b7-b434-60f8bd0fb3ee%3Aimage.png?table=block&amp;id=2737c031-1dd6-80d4-a4a8-d16bb5eee913&amp;t=2737c031-1dd6-80d4-a4a8-d16bb5eee913\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><h3 class=\"notion-h notion-h2 notion-h-indent-0 notion-block-2737c0311dd6805eb3fcd42174d455ed\" data-id=\"2737c0311dd6805eb3fcd42174d455ed\"><span><div id=\"2737c0311dd6805eb3fcd42174d455ed\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2737c0311dd6805eb3fcd42174d455ed\" title=\"调用栈分析\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">调用栈分析</span></span></h3><div class=\"notion-text notion-block-2737c0311dd68060908aec7be6859648\">跟进到该类看代码，在handle中调用了handleSecurely()</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd6806aac42f35df21e8aae\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A94317421-ca9c-45e6-8546-635aafbfe364%3Aimage.png?table=block&amp;id=2737c031-1dd6-806a-ac42-f35df21e8aae&amp;t=2737c031-1dd6-806a-ac42-f35df21e8aae\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd680458fd0d1d49c307b41\">跟进handleSecurely方法，这里并没有传递<code class=\"notion-inline-code\">org.jolokia.jaasSubject</code>属性，所以执行了<code class=\"notion-inline-code\">pReqHandler.handleRequest(pReq, pResp);</code></div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd68027a7ece5fb2550fa1d\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A460f7089-7722-4395-905d-2fc646193f1c%3Aimage.png?table=block&amp;id=2737c031-1dd6-8027-a7ec-e5fb2550fa1d&amp;t=2737c031-1dd6-8027-a7ec-e5fb2550fa1d\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd6805a807aedfb6e276139\">继续跟进handleRequest方法，这里创建了<code class=\"notion-inline-code\">ServletRequestHandler</code>对象返回给<code class=\"notion-inline-code\">json</code>来处理POST类型的HTTP请求</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd6809da143e3cf247823f5\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A85d19751-d673-44f3-95af-6fa84308a34e%3Aimage.png?table=block&amp;id=2737c031-1dd6-809d-a143-e3cf247823f5&amp;t=2737c031-1dd6-809d-a143-e3cf247823f5\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd68065a434d8666b887aa3\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A4689c0fd-2aad-4ffb-be6c-d6fc114261cb%3Aimage.png?table=block&amp;id=2737c031-1dd6-8065-a434-d8666b887aa3&amp;t=2737c031-1dd6-8065-a434-d8666b887aa3\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd68084a6fdd36e949bb6ce\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Aae214c90-d588-4009-a3bc-6730a5dccd2a%3Aimage.png?table=block&amp;id=2737c031-1dd6-8084-a6fd-d36e949bb6ce&amp;t=2737c031-1dd6-8084-a6fd-d36e949bb6ce\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd680ce88f7f90d771c8a50\">这里extractJsonRequest方法的确就是从POST请求的输入流中,读取输入数据,然后解析出JSON格式的数据,转换为JSON对象，然后利用JmxRequestFactory来创建一个JmxRequest对象，其中封装了对JMX管理功能的相关请求信息。然后调用executeRequest处理。</div><div class=\"notion-text notion-block-2737c0311dd680388ec7d8380ba5db04\">继续跟进executeRequest</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd680a5a104c0b47e0bbb92\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Af8b9b1e8-cf7e-43ef-ab46-8dce4455296a%3Aimage.png?table=block&amp;id=2737c031-1dd6-80a5-a104-c0b47e0bbb92&amp;t=2737c031-1dd6-80a5-a104-c0b47e0bbb92\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd68045a21eee023ff287b5\">这里调用了backendManager.handleRequest，继续跟进</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd68009b7f7d194cc322c26\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Ab6e07f83-79db-454d-8d75-81180e1dc776%3Aimage.png?table=block&amp;id=2737c031-1dd6-8009-b7f7-d194cc322c26&amp;t=2737c031-1dd6-8009-b7f7-d194cc322c26\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd68032b400e7558bce0c5a\">调用callRequestDispatcher方法,传入JmxRequest请求对象,进行请求调度处理，继续跟进</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd68010ad0de224601de9b7\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A6305815e-5d43-49c4-9717-96128387b302%3Aimage.png?table=block&amp;id=2737c031-1dd6-8010-ad0d-e224601de9b7&amp;t=2737c031-1dd6-8010-ad0d-e224601de9b7\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd6800a86dfe207551bce67\">通过一层层的调度和分发,最终将JMX请求交给了对应的<code class=\"notion-inline-code\">ExecHandler</code>来处理EXEC类型的请求。</div><ol start=\"1\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd6809ebf12d6261ea9be2f\"><li>request.getObjectName() 获取了请求中指定的目标MBean的对象名(ObjectName)</li></ol><ol start=\"2\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd680aabacac38599ba5b80\"><li>types.operationName 获取了请求中指定的目标MBean中的方法名</li></ol><ol start=\"3\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd68068978ec40e3d35d2a0\"><li>params 包含了请求中传入的方法参数</li></ol><ol start=\"4\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd680379015e7a994e0ea0d\"><li>types.paramClasses 包含了目标方法的参数类型</li></ol><ol start=\"5\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd680bc8a46fb365ec7b0ab\"><li>然后利用JMX服务器的MBeanServerConnection对象的invoke方法,按照JMX的反射调用机制,动态调用了目标MBean中的指定方法</li></ol><div class=\"notion-text notion-block-2737c0311dd680ddb633e91a7d0ba77f\">通过这种方式,请求可以构造一个任意已注册在JMX服务器中的MBean对象以及其方法,然后动态执行其中的方法</div><h3 class=\"notion-h notion-h2 notion-h-indent-0 notion-block-2737c0311dd68047a32cf87f190569b2\" data-id=\"2737c0311dd68047a32cf87f190569b2\"><span><div id=\"2737c0311dd68047a32cf87f190569b2\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2737c0311dd68047a32cf87f190569b2\" title=\"RCE\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">RCE</span></span></h3><div class=\"notion-text notion-block-2737c0311dd6803d9e63fbb31f520a34\">根据补丁来看，修改了jolokia-access.xml文件。在 ActiveMQ 中，<code class=\"notion-inline-code\">jolokia-access.xml</code> 文件用于定义哪些 MBean 和操作是允许或拒绝的。</div><div class=\"notion-text notion-block-2737c0311dd680f0b8e2c16df33ad304\">其中新增了对jdk.management.jfr:type=FlightRecorder的限制，拒绝了对该 MBean 的所有属性和操作的访问。</div><div class=\"notion-text notion-block-2737c0311dd68094b784c0cf9072b406\">在Apache的官方通告中，也说明了RCE是通过FlightRecorder来实现的，并且告诉了步骤：</div><ol start=\"1\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd6800da106e9cf7a34b459\"><li>调用newRecording</li></ol><ol start=\"2\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd68020b322dcd8a845f415\"><li>调用setConfiguration，其中包含Webshell数据</li></ol><ol start=\"3\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd6809fb324f3157f07ecc6\"><li>调用startRecording</li></ol><ol start=\"4\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd6803d9598f03932a8b82d\"><li>调用copyTo方法来写入WebShell</li></ol><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd680f48127cb2c641edbe0\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:567px;max-width:100%;flex-direction:column\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A63553a5f-bef8-465c-812c-b0899f330d4f%3Aimage.png?table=block&amp;id=2737c031-1dd6-80f4-8127-cb2c641edbe0&amp;t=2737c031-1dd6-80f4-8127-cb2c641edbe0\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd680918296c3f933246fe8\">jdk.management.jfr.FlightRecorderMXBeanImpl类是JDK Flight Recorder管理接口的实现类</div><div class=\"notion-text notion-block-2737c0311dd6804c9299e5042d787a45\">关于JDK Flight Recorder:</div><ul class=\"notion-list notion-list-disc notion-block-2737c0311dd680659727efe9c072b3e2\"><li>它是JVM内置的事件记录和分析工具,可以用来收集JVM的内部运行时信息,分析JVM和Java应用程序的行为。</li></ul><ul class=\"notion-list notion-list-disc notion-block-2737c0311dd68014acb8c1ef0ed15252\"><li>通过它收集到的数据,可以找到各种性能问题并优化Java应用程序。</li></ul><div class=\"notion-text notion-block-2737c0311dd68027a657e447f71a9672\">关于jdk.management.jfr.FlightRecorderMXBeanImpl类:</div><ul class=\"notion-list notion-list-disc notion-block-2737c0311dd680d7b9cdeb39cd637bcb\"><li>它实现了jdk.management.jfr.FlightRecorderMXBean接口。</li></ul><ul class=\"notion-list notion-list-disc notion-block-2737c0311dd68038a0a8fb33fb7a87da\"><li>FlightRecorderMXBean接口定义了一系列管理Flight Recorder的方法。</li></ul><ul class=\"notion-list notion-list-disc notion-block-2737c0311dd680d3a526dad5a5e77b0f\"><li>FlightRecorderMXBeanImpl实现了这些管理方法来控制Flight Recorder的行为。</li></ul><ul class=\"notion-list notion-list-disc notion-block-2737c0311dd680d0aa1eedf9b59c15b1\"><li>这些方法包括:开始和停止recording,获取recording数据,设置recording的配置等。</li></ul><ul class=\"notion-list notion-list-disc notion-block-2737c0311dd68085a443cf1e11e42a9c\"><li>JConsole和其他管理工具可以通过这些MXBean接口来管理Flight Recorder。</li></ul><div class=\"notion-text notion-block-2737c0311dd680d0b39fedc3a317762e\">接下来我们来跟进代码，看看这几个方法的实现</div><div class=\"notion-text notion-block-2737c0311dd68047aca0d8485341730b\"><b>newRecording()</b> 这里就是new一个Recording对象，返回ID，后续根据ID访问这个recording实例,并进行后续的配置、开始/停止记录等操作</div><div class=\"notion-text notion-block-2737c0311dd680928413d6212800d5d7\"><b>setConfiguration()</b> 传入Recorder ID和配置文件，解析配置文件，如果符合格式，就会采用该配置文件</div><div class=\"notion-text notion-block-2737c0311dd6802e882ff7e14d0c4387\">在<a target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link\" href=\"https://docs.oracle.com/en/java/javase/17/jfapi/flight-recorder-configurations.html#GUID-51B499C9-CF15-48EE-9AAA-47BB69CBDABF\">Oracle官方文档</a>中有介绍默认模版在<code class=\"notion-inline-code\">&lt;java_home&gt;/lib/jfr/default.jfc</code></div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd6801eb43aeb94b3bd5bd9\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:698px;max-width:100%;flex-direction:column\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Aec6bf56b-cb7e-4030-aad4-407e02b690e5%3Aimage.png?table=block&amp;id=2737c031-1dd6-801e-b43a-eb94b3bd5bd9&amp;t=2737c031-1dd6-801e-b43a-eb94b3bd5bd9\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd68097a119cfc83248cd1f\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Ab8da4d39-94d9-48bf-aad7-30e92faf9681%3Aimage.png?table=block&amp;id=2737c031-1dd6-8097-a119-cfc83248cd1f&amp;t=2737c031-1dd6-8097-a119-cfc83248cd1f\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd680a0a984ec6efb308ec8\">构造包含WebShell的配置文件，特殊字符经过html实体编码</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd68000aba9e7470fdad595\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A1c8a44ce-4a24-43c8-ace6-1a50ce496ca2%3Aimage.png?table=block&amp;id=2737c031-1dd6-8000-aba9-e7470fdad595&amp;t=2737c031-1dd6-8000-aba9-e7470fdad595\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd6808da733e3921083fb9e\"><b>startRecording</b> 传入Recording ID，然后开始录制</div><div class=\"notion-text notion-block-2737c0311dd68019973cc5327bbe5ba1\"><b>stopRecording</b>传入Recording ID，结束录制</div><div class=\"notion-text notion-block-2737c0311dd6807d88b2c15727f7ebb2\"><b>copyTo</b> 传入Recording ID和保存路径，这个路径没做限制，我们可以路径穿越到web目录去</div><div class=\"notion-text notion-block-2737c0311dd680f2bf62d58c388b0e41\"><b>完整思路如下：</b></div><ol start=\"1\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd6800c9114d3da70a45554\"><li>构造恶意请求,传入目标MBean为FlightRecorderMXBean，调用FlightRecorderMXBean的newRecording方法创建一个新的Recording对象</li></ol><ol start=\"2\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd6800d8a7cf4a668d243de\"><li>调用setConfiguration方法,设置Recording使用的配置文件,在配置文件中的键名中插入WebShell。由于导出的数据会包含键名，所以当我们在键名中插入WebShell时，导出的数据也会包含该WebShell</li></ol><ol start=\"3\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd68085bd7cdc7dd3402dfd\"><li>调用startRecording开启事件记录</li></ol><ol start=\"4\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd680c3b90becfb01fd8f8e\"><li>调用stopRecording停止事件记录</li></ol><ol start=\"5\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd6808cb6dafdd942080cd6\"><li>调用copyTo方法,将记录的数据保存到指定文件,这里我们可以指定为web应用目录下的一个jsp文件</li></ol><ol start=\"6\" class=\"notion-list notion-list-numbered notion-block-2737c0311dd6802ba2c4d7773e0ed8d3\"><li>这样最终就实现了写入一个包含恶意命令执行代码的WebShell文件，之后访问这个WebShell,命令就会被执行</li></ol><h2 class=\"notion-h notion-h1 notion-h-indent-0 notion-block-2737c0311dd680a48672d4ee3c71af25\" data-id=\"2737c0311dd680a48672d4ee3c71af25\"><span><div id=\"2737c0311dd680a48672d4ee3c71af25\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2737c0311dd680a48672d4ee3c71af25\" title=\"漏洞复现\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">漏洞复现</span></span></h2><div class=\"notion-text notion-block-2737c0311dd6807ba0edddb90f00ca1b\">从<a target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link\" href=\"https://stackoverflow.com/questions/27707190/activemq-jolokia-api-how-can-i-get-the-full-message-body\">stackoverflow</a>找到了jolokia api的使用案例</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd680b9a7c9e5e0de6499f2\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Afbea4ac7-ca5d-44d0-aa83-d0c05ecc4416%3Aimage.png?table=block&amp;id=2737c031-1dd6-80b9-a7c9-e5e0de6499f2&amp;t=2737c031-1dd6-80b9-a7c9-e5e0de6499f2\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd6809fa51dd4e81a97da0b\"><b>构造数据包：</b></div><div class=\"notion-text notion-block-2737c0311dd6801690d8e49fad06cf8f\">1、调用newRecording，获取ID为1</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd6805892fef1145c673749\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Acf6dfff3-5c23-4318-ad8b-5fc0a556a762%3Aimage.png?table=block&amp;id=2737c031-1dd6-8058-92fe-f1145c673749&amp;t=2737c031-1dd6-8058-92fe-f1145c673749\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd68091bf2dd5b7934c036e\">2、调用setConfiguration构造包含WebShell的配置文件，注意需要把xml数据的双引号转义并去除换行</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd6805fa29aee4fa756e979\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Ad0cb0246-4f43-44c8-9a90-5bfc8e8536e5%3Aimage.png?table=block&amp;id=2737c031-1dd6-805f-a29a-ee4fa756e979&amp;t=2737c031-1dd6-805f-a29a-ee4fa756e979\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd680bc8409e2486200c17c\">3、开始录制数据</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd680eeb75af6fbc34d8575\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A17c7fba9-4f80-40c5-8218-6dec763143eb%3Aimage.png?table=block&amp;id=2737c031-1dd6-80ee-b75a-f6fbc34d8575&amp;t=2737c031-1dd6-80ee-b75a-f6fbc34d8575\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd68009b2ccf7e28b300212\">4、结束录制</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd6802b84a5ddc77af440e1\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A65fd849b-0d82-4c48-9fd2-0c784f86f490%3Aimage.png?table=block&amp;id=2737c031-1dd6-802b-84a5-ddc77af440e1&amp;t=2737c031-1dd6-802b-84a5-ddc77af440e1\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd68044bce8cdb48e7a53eb\">5、调用copyTo，将文件写入webapps/admin/le1a.jsp</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd68049b155c9af54872964\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Aaf44c154-60ae-40bc-8a5a-33c662ac53fd%3Aimage.png?table=block&amp;id=2737c031-1dd6-8049-b155-c9af54872964&amp;t=2737c031-1dd6-8049-b155-c9af54872964\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2737c0311dd680c38c81d201af7c90d0\">6、访问/admin/le1a.jsp，成功弹出计算器，漏洞验证成功！</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2737c0311dd680d9bde8ed06aef69149\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A0ade65e5-6764-4122-b96d-2c4d07e63b52%3Aimage.png?table=block&amp;id=2737c031-1dd6-80d9-bde8-ed06aef69149&amp;t=2737c031-1dd6-80d9-bde8-ed06aef69149\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure></main></div>",
            "url": "https://le1a.github.io/article/2737c031-1dd6-8018-a702-ef94ca1acb04",
            "title": "Apache ActiveMQ jolokia 远程代码执行漏洞分析(CVE-2022-41678)",
            "date_modified": "2023-11-30T16:00:00.000Z"
        },
        {
            "content_html": "该文章需要密码才能查看！",
            "url": "https://le1a.github.io/article/race-condition-reset-passwd",
            "title": "青龙面板 权限绕过漏洞分析",
            "summary": "该文章需要密码才能查看！",
            "date_modified": "2024-12-17T00:00:00.000Z"
        },
        {
            "content_html": "<div id=\"notion-article\" class=\"mx-auto overflow-hidden \"><main class=\"notion light-mode notion-page notion-block-2117c0311dd6802c95eddf9cc9f5f353\"><div class=\"notion-viewport\"></div><div class=\"notion-collection-page-properties\"></div><div class=\"notion-text notion-block-25a7c0311dd680a2b65ae2f48250a5e8\">killer大哥公开<a target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link\" href=\"https://mp.weixin.qq.com/s/aIyGt5OKlYCL-NPfd0G2Jw\">详情</a>了，我这儿也就不加密了。killer大哥太细节了，还分析了如何解密补丁。</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-25a7c0311dd68062bae4e032f24f1279\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:240px;max-width:100%;flex-direction:column\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A37436c83-f0c9-40ec-8907-6dea9005d6c2%3AWechatIMG172.gif?table=block&amp;id=25a7c031-1dd6-8062-bae4-e032f24f1279&amp;t=25a7c031-1dd6-8062-bae4-e032f24f1279\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><h2 class=\"notion-h notion-h1 notion-h-indent-0 notion-block-2117c0311dd680d28f8ad8bc1e521847\" data-id=\"2117c0311dd680d28f8ad8bc1e521847\"><span><div id=\"2117c0311dd680d28f8ad8bc1e521847\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2117c0311dd680d28f8ad8bc1e521847\" title=\"环境搭建\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">环境搭建</span></span></h2><div class=\"notion-text notion-block-2117c0311dd680c391e3c512a73de21f\">通过安装包一键安装，在startup.cmd/sh添加远程调试的配置</div><div class=\"notion-text notion-block-2117c0311dd6804b9cc5daaf3bfa440f\">然后运行运行startup即可</div><h2 class=\"notion-h notion-h1 notion-h-indent-0 notion-block-2117c0311dd680988427e22293bbe430\" data-id=\"2117c0311dd680988427e22293bbe430\"><span><div id=\"2117c0311dd680988427e22293bbe430\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2117c0311dd680988427e22293bbe430\" title=\"漏洞分析\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">漏洞分析</span></span></h2><h3 class=\"notion-h notion-h2 notion-h-indent-1 notion-block-2117c0311dd680c28ac3e031252c2b31\" data-id=\"2117c0311dd680c28ac3e031252c2b31\"><span><div id=\"2117c0311dd680c28ac3e031252c2b31\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2117c0311dd680c28ac3e031252c2b31\" title=\"权限绕过\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">权限绕过</span></span></h3><div class=\"notion-text notion-block-2117c0311dd6802d86f1c95341e2a7ba\">在vision/share.jsp中，这里获取resid的值，在<code class=\"notion-inline-code\">shareService.isPublicShareResourceByShareType(resid, sharetype)</code> 验证resid存在后，调用<code class=\"notion-inline-code\">JSONObject result = shareService.getShareRestrictByShareType(resid, sharetype);</code></div><div class=\"notion-text notion-block-2117c0311dd68094966fff2c9b315d10\">这里继续跟进<code class=\"notion-inline-code\">shareService.getShareRestrictByShareType()</code> </div><div class=\"notion-text notion-block-2117c0311dd680fc8a73ef97006d3834\">因为<code class=\"notion-inline-code\">shareType</code>是空的，所以直接调用\n<code class=\"notion-inline-code\">this.shareRestrict(relateid, (String)null, (String)null, (String)null);</code></div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2117c0311dd6802580cce6a86caebd0c\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Abd7d8517-9b52-4394-88a3-8fb2447d2577%3Aimage.png?table=block&amp;id=2117c031-1dd6-8025-80cc-e6a86caebd0c&amp;t=2117c031-1dd6-8025-80cc-e6a86caebd0c\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2117c0311dd6803a97fde13d383ea36a\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A5f144457-8693-4d00-885f-1ec8e81ce237%3Aimage.png?table=block&amp;id=2117c031-1dd6-803a-97fd-e13d383ea36a&amp;t=2117c031-1dd6-803a-97fd-e13d383ea36a\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2117c0311dd6805bb485df8a23a99323\">直接返回false，那么最终jsp的result变量的值就是false，无法进入if，直接调用\n<code class=\"notion-inline-code\">UserManagerModule.getInstance().autoLoginByPublicUser();</code>切换至Public用户并返回Session</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2117c0311dd680ee9debe01eeeb53d6b\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Af846685d-d59b-4758-b8c2-1534b73d96cb%3Aimage.png?table=block&amp;id=2117c031-1dd6-80ee-9deb-e01eeeb53d6b&amp;t=2117c031-1dd6-80ee-9deb-e01eeeb53d6b\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2117c0311dd6807b93d6fd7fd49ea750\">也就是我们只有知道一个存在的resid即可获取合法Session。</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2117c0311dd6803f839ad9c81dbe0f49\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Abddd68e6-baf1-473e-8165-97a79ff437a4%3Aimage.png?table=block&amp;id=2117c031-1dd6-803f-839a-d9c81dbe0f49&amp;t=2117c031-1dd6-803f-839a-d9c81dbe0f49\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2117c0311dd68025ae18f55df6b84c7f\">最终可以定位到是从t_share_record中查询c_relateid的值</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2117c0311dd680f8a668ff0522da735a\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3Ae54b31c3-8836-470e-b2e9-b8f765726e02%3Aimage.png?table=block&amp;id=2117c031-1dd6-80f8-a668-ff0522da735a&amp;t=2117c031-1dd6-80f8-a668-ff0522da735a\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-blank notion-block-2117c0311dd680eaa468fc9d6fccadde\"> </div><div class=\"notion-text notion-block-2117c0311dd680028b8ee82556bda343\">这里的5条都是安装后默认的</div><div class=\"notion-text notion-block-2117c0311dd68019997bd940c7f882fc\">发送以下请求即可获取合法Session</div><h3 class=\"notion-h notion-h2 notion-h-indent-1 notion-block-2537c0311dd680c786f1d8d9a5aaf827\" data-id=\"2537c0311dd680c786f1d8d9a5aaf827\"><span><div id=\"2537c0311dd680c786f1d8d9a5aaf827\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2537c0311dd680c786f1d8d9a5aaf827\" title=\"补充坑点\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\"><b>补充坑点</b></span></span></h3><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2537c0311dd68026a26fe7bbd4c7709e\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A9ae90b00-de4d-4780-9477-043ff0949929%3Aa7d4749f-8c81-4951-b14c-3720bdb8b335.png?table=block&amp;id=2537c031-1dd6-8026-a26f-e7bbd4c7709e&amp;t=2537c031-1dd6-8026-a26f-e7bbd4c7709e\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2537c0311dd680b6a774c505fb6bfd82\">这里需要为true才能进入if。但是在<code class=\"notion-inline-code\">smartbi/module/socialcontactshare/SocialContactShareService.class#isPublicShareResourceByShareType()</code></div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2537c0311dd6800c8214eeeedb1a89cf\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A7ea7673c-12ba-45dc-a5bd-a692cf0e0cb6%3A449265d8-d33d-473e-8b98-5c5c95bc5448.png?table=block&amp;id=2537c031-1dd6-800c-8214-eeeedb1a89cf&amp;t=2537c031-1dd6-800c-8214-eeeedb1a89cf\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-text notion-block-2537c0311dd680ada9b8fb5787c6bd3c\">需要<code class=\"notion-inline-code\">publicshared</code>为1才行。所以只有<code class=\"notion-inline-code\">96a0a9d0b86f90d5416d013f4cfe2f23</code>和<code class=\"notion-inline-code\">b904ab9f5a84712a672523a7b4881ee4</code>可用</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2537c0311dd680b8a1eec95c152850ad\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A19ad77bc-46cb-4557-9444-49e53e230b70%3A13b9a7a3-46a3-4523-903e-5f835b09fbbc.png?table=block&amp;id=2537c031-1dd6-80b8-a1ee-c95c152850ad&amp;t=2537c031-1dd6-80b8-a1ee-c95c152850ad\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><h3 class=\"notion-h notion-h2 notion-h-indent-1 notion-block-2117c0311dd680c68a50f61dac0303aa\" data-id=\"2117c0311dd680c68a50f61dac0303aa\"><span><div id=\"2117c0311dd680c68a50f61dac0303aa\" class=\"notion-header-anchor\"></div><a class=\"notion-hash-link\" href=\"#2117c0311dd680c68a50f61dac0303aa\" title=\"后台RCE\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a><span class=\"notion-h-title\">后台RCE</span></span></h3><div class=\"notion-text notion-block-2117c0311dd68057a661fdbbac4ba531\"><code class=\"notion-inline-code\">smartbix.smartbi.metricsmodel.MetricsModelForVModule#checkExpression()</code> </div><div class=\"notion-text notion-block-2117c0311dd6809aa665c4805a949668\">这个方法直接调用js引擎执行了传入的表达式。</div><div class=\"notion-text notion-block-2117c0311dd6803f9255c8c56ac2aa31\">而SmartBI有一个<code class=\"notion-inline-code\">smartbi.framework.rmi.RMIServlet</code>可以通过<code class=\"notion-inline-code\">smartbi.framework.rmi.ClientService#executeInternal</code>反射调用任何方法,具体分析见<a target=\"_blank\" rel=\"noopener noreferrer\" class=\"notion-link\" href=\"https://www.ch35tnut.com/zh-cn/vulnerability/smartbi-rce/\">https://www.ch35tnut.com/zh-cn/vulnerability/smartbi-rce/</a>，这里就不再阐述了。</div><div class=\"notion-text notion-block-2117c0311dd680ad85bcf8e939877837\">最终PoC</div><figure class=\"notion-asset-wrapper notion-asset-wrapper-image notion-block-2117c0311dd68012a0f0e0738eb9e73a\"><div style=\"position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%\"><img style=\"object-fit:cover\" src=\"https://www.notion.so/image/attachment%3A38859e17-a812-4922-8b35-297f1bb17ab0%3Aimage.png?table=block&amp;id=2117c031-1dd6-8012-a0f0-e0738eb9e73a&amp;t=2117c031-1dd6-8012-a0f0-e0738eb9e73a\" alt=\"notion image\" loading=\"lazy\" decoding=\"async\"/></div></figure><div class=\"notion-blank notion-block-2117c0311dd68055b01afbc93356f7f8\"> </div></main></div>",
            "url": "https://le1a.github.io/article/2117c031-1dd6-802c-95ed-df9cc9f5f353",
            "title": "SmartBI 权限绕过&RCE漏洞分析",
            "date_modified": "2025-08-17T16:00:00.000Z"
        },
        {
            "content_html": "该文章需要密码才能查看！",
            "url": "https://le1a.github.io/article/2587c031-1dd6-804d-8b9d-c9a942af44a1",
            "title": "某堡垒机 认证绕过漏洞",
            "summary": "该文章需要密码才能查看！",
            "date_modified": "2025-08-22T16:00:00.000Z"
        },
        {
            "content_html": "该文章需要密码才能查看！",
            "url": "https://le1a.github.io/article/23f7c031-1dd6-80cd-a698-cb9bbd1692a0",
            "title": "用友U8Cloud 反射调用 → 文件上传漏洞",
            "summary": "该文章需要密码才能查看！",
            "date_modified": "2025-07-28T16:00:00.000Z"
        }
    ]
}