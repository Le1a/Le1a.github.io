<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Le1a的菜园坝 </title>
        <link>https://le1a.github.io/</link>
        <description>一个NotionNext搭建的博客</description>
        <lastBuildDate>Mon, 25 Aug 2025 06:34:36 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>zh-CN</language>
        <copyright>All rights reserved 2025, Le1a</copyright>
        <item>
            <title><![CDATA[SmartBI 权限绕过&RCE漏洞分析]]></title>
            <link>https://le1a.github.io/article/2117c031-1dd6-802c-95ed-df9cc9f5f353</link>
            <guid>https://le1a.github.io/article/2117c031-1dd6-802c-95ed-df9cc9f5f353</guid>
            <pubDate>Sun, 17 Aug 2025 16:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<div id="notion-article" class="mx-auto overflow-hidden "><main class="notion light-mode notion-page notion-block-2117c0311dd6802c95eddf9cc9f5f353"><div class="notion-viewport"></div><div class="notion-collection-page-properties"></div><div class="notion-text notion-block-25a7c0311dd680a2b65ae2f48250a5e8">killer大哥公开<a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://mp.weixin.qq.com/s/aIyGt5OKlYCL-NPfd0G2Jw">详情</a>了，我这儿也就不加密了。killer大哥太细节了，还分析了如何解密补丁。</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-25a7c0311dd68062bae4e032f24f1279"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:240px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3A37436c83-f0c9-40ec-8907-6dea9005d6c2%3AWechatIMG172.gif?table=block&amp;id=25a7c031-1dd6-8062-bae4-e032f24f1279&amp;t=25a7c031-1dd6-8062-bae4-e032f24f1279" alt="notion image" loading="lazy" decoding="async"/></div></figure><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-2117c0311dd680d28f8ad8bc1e521847" data-id="2117c0311dd680d28f8ad8bc1e521847"><span><div id="2117c0311dd680d28f8ad8bc1e521847" class="notion-header-anchor"></div><a class="notion-hash-link" href="#2117c0311dd680d28f8ad8bc1e521847" title="环境搭建"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">环境搭建</span></span></h2><div class="notion-text notion-block-2117c0311dd680c391e3c512a73de21f">通过安装包一键安装，在startup.cmd/sh添加远程调试的配置</div><div class="notion-text notion-block-2117c0311dd6804b9cc5daaf3bfa440f">然后运行运行startup即可</div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-2117c0311dd680988427e22293bbe430" data-id="2117c0311dd680988427e22293bbe430"><span><div id="2117c0311dd680988427e22293bbe430" class="notion-header-anchor"></div><a class="notion-hash-link" href="#2117c0311dd680988427e22293bbe430" title="漏洞分析"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">漏洞分析</span></span></h2><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-2117c0311dd680c28ac3e031252c2b31" data-id="2117c0311dd680c28ac3e031252c2b31"><span><div id="2117c0311dd680c28ac3e031252c2b31" class="notion-header-anchor"></div><a class="notion-hash-link" href="#2117c0311dd680c28ac3e031252c2b31" title="权限绕过"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">权限绕过</span></span></h3><div class="notion-text notion-block-2117c0311dd6802d86f1c95341e2a7ba">在vision/share.jsp中，这里获取resid的值，在<code class="notion-inline-code">shareService.isPublicShareResourceByShareType(resid, sharetype)</code> 验证resid存在后，调用<code class="notion-inline-code">JSONObject result = shareService.getShareRestrictByShareType(resid, sharetype);</code></div><div class="notion-text notion-block-2117c0311dd68094966fff2c9b315d10">这里继续跟进<code class="notion-inline-code">shareService.getShareRestrictByShareType()</code> </div><div class="notion-text notion-block-2117c0311dd680fc8a73ef97006d3834">因为<code class="notion-inline-code">shareType</code>是空的，所以直接调用
<code class="notion-inline-code">this.shareRestrict(relateid, (String)null, (String)null, (String)null);</code></div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-2117c0311dd6802580cce6a86caebd0c"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3Abd7d8517-9b52-4394-88a3-8fb2447d2577%3Aimage.png?table=block&amp;id=2117c031-1dd6-8025-80cc-e6a86caebd0c&amp;t=2117c031-1dd6-8025-80cc-e6a86caebd0c" alt="notion image" loading="lazy" decoding="async"/></div></figure><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-2117c0311dd6803a97fde13d383ea36a"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3A5f144457-8693-4d00-885f-1ec8e81ce237%3Aimage.png?table=block&amp;id=2117c031-1dd6-803a-97fd-e13d383ea36a&amp;t=2117c031-1dd6-803a-97fd-e13d383ea36a" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-2117c0311dd6805bb485df8a23a99323">直接返回false，那么最终jsp的result变量的值就是false，无法进入if，直接调用
<code class="notion-inline-code">UserManagerModule.getInstance().autoLoginByPublicUser();</code>切换至Public用户并返回Session</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-2117c0311dd680ee9debe01eeeb53d6b"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3Af846685d-d59b-4758-b8c2-1534b73d96cb%3Aimage.png?table=block&amp;id=2117c031-1dd6-80ee-9deb-e01eeeb53d6b&amp;t=2117c031-1dd6-80ee-9deb-e01eeeb53d6b" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-2117c0311dd6807b93d6fd7fd49ea750">也就是我们只有知道一个存在的resid即可获取合法Session。</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-2117c0311dd6803f839ad9c81dbe0f49"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3Abddd68e6-baf1-473e-8165-97a79ff437a4%3Aimage.png?table=block&amp;id=2117c031-1dd6-803f-839a-d9c81dbe0f49&amp;t=2117c031-1dd6-803f-839a-d9c81dbe0f49" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-2117c0311dd68025ae18f55df6b84c7f">最终可以定位到是从t_share_record中查询c_relateid的值</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-2117c0311dd680f8a668ff0522da735a"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3Ae54b31c3-8836-470e-b2e9-b8f765726e02%3Aimage.png?table=block&amp;id=2117c031-1dd6-80f8-a668-ff0522da735a&amp;t=2117c031-1dd6-80f8-a668-ff0522da735a" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-blank notion-block-2117c0311dd680eaa468fc9d6fccadde"> </div><div class="notion-text notion-block-2117c0311dd680028b8ee82556bda343">这里的5条都是安装后默认的</div><div class="notion-text notion-block-2117c0311dd68019997bd940c7f882fc">发送以下请求即可获取合法Session</div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-2537c0311dd680c786f1d8d9a5aaf827" data-id="2537c0311dd680c786f1d8d9a5aaf827"><span><div id="2537c0311dd680c786f1d8d9a5aaf827" class="notion-header-anchor"></div><a class="notion-hash-link" href="#2537c0311dd680c786f1d8d9a5aaf827" title="补充坑点"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>补充坑点</b></span></span></h3><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-2537c0311dd68026a26fe7bbd4c7709e"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3A9ae90b00-de4d-4780-9477-043ff0949929%3Aa7d4749f-8c81-4951-b14c-3720bdb8b335.png?table=block&amp;id=2537c031-1dd6-8026-a26f-e7bbd4c7709e&amp;t=2537c031-1dd6-8026-a26f-e7bbd4c7709e" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-2537c0311dd680b6a774c505fb6bfd82">这里需要为true才能进入if。但是在<code class="notion-inline-code">smartbi/module/socialcontactshare/SocialContactShareService.class#isPublicShareResourceByShareType()</code></div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-2537c0311dd6800c8214eeeedb1a89cf"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3A7ea7673c-12ba-45dc-a5bd-a692cf0e0cb6%3A449265d8-d33d-473e-8b98-5c5c95bc5448.png?table=block&amp;id=2537c031-1dd6-800c-8214-eeeedb1a89cf&amp;t=2537c031-1dd6-800c-8214-eeeedb1a89cf" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-2537c0311dd680ada9b8fb5787c6bd3c">需要<code class="notion-inline-code">publicshared</code>为1才行。所以只有<code class="notion-inline-code">96a0a9d0b86f90d5416d013f4cfe2f23</code>和<code class="notion-inline-code">b904ab9f5a84712a672523a7b4881ee4</code>可用</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-2537c0311dd680b8a1eec95c152850ad"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3A19ad77bc-46cb-4557-9444-49e53e230b70%3A13b9a7a3-46a3-4523-903e-5f835b09fbbc.png?table=block&amp;id=2537c031-1dd6-80b8-a1ee-c95c152850ad&amp;t=2537c031-1dd6-80b8-a1ee-c95c152850ad" alt="notion image" loading="lazy" decoding="async"/></div></figure><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-2117c0311dd680c68a50f61dac0303aa" data-id="2117c0311dd680c68a50f61dac0303aa"><span><div id="2117c0311dd680c68a50f61dac0303aa" class="notion-header-anchor"></div><a class="notion-hash-link" href="#2117c0311dd680c68a50f61dac0303aa" title="后台RCE"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">后台RCE</span></span></h3><div class="notion-text notion-block-2117c0311dd68057a661fdbbac4ba531"><code class="notion-inline-code">smartbix.smartbi.metricsmodel.MetricsModelForVModule#checkExpression()</code> </div><div class="notion-text notion-block-2117c0311dd6809aa665c4805a949668">这个方法直接调用js引擎执行了传入的表达式。</div><div class="notion-text notion-block-2117c0311dd6803f9255c8c56ac2aa31">而SmartBI有一个<code class="notion-inline-code">smartbi.framework.rmi.RMIServlet</code>可以通过<code class="notion-inline-code">smartbi.framework.rmi.ClientService#executeInternal</code>反射调用任何方法,具体分析见<a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://www.ch35tnut.com/zh-cn/vulnerability/smartbi-rce/">https://www.ch35tnut.com/zh-cn/vulnerability/smartbi-rce/</a>，这里就不再阐述了。</div><div class="notion-text notion-block-2117c0311dd680ad85bcf8e939877837">最终PoC</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-2117c0311dd68012a0f0e0738eb9e73a"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3A38859e17-a812-4922-8b35-297f1bb17ab0%3Aimage.png?table=block&amp;id=2117c031-1dd6-8012-a0f0-e0738eb9e73a&amp;t=2117c031-1dd6-8012-a0f0-e0738eb9e73a" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-blank notion-block-2117c0311dd68055b01afbc93356f7f8"> </div></main></div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[某堡垒机 认证绕过漏洞]]></title>
            <link>https://le1a.github.io/article/2587c031-1dd6-804d-8b9d-c9a942af44a1</link>
            <guid>https://le1a.github.io/article/2587c031-1dd6-804d-8b9d-c9a942af44a1</guid>
            <pubDate>Fri, 22 Aug 2025 16:00:00 GMT</pubDate>
            <description><![CDATA[该文章需要密码才能查看！]]></description>
            <content:encoded><![CDATA[该文章需要密码才能查看！]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[用友U8Cloud 反射调用 → 文件上传漏洞]]></title>
            <link>https://le1a.github.io/article/23f7c031-1dd6-80cd-a698-cb9bbd1692a0</link>
            <guid>https://le1a.github.io/article/23f7c031-1dd6-80cd-a698-cb9bbd1692a0</guid>
            <pubDate>Mon, 28 Jul 2025 16:00:00 GMT</pubDate>
            <description><![CDATA[该文章需要密码才能查看！]]></description>
            <content:encoded><![CDATA[该文章需要密码才能查看！]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[契约锁 pdfverifier ZipSlip漏洞简要分析]]></title>
            <link>https://le1a.github.io/article/2247c031-1dd6-804a-b694-f259cff19044</link>
            <guid>https://le1a.github.io/article/2247c031-1dd6-804a-b694-f259cff19044</guid>
            <pubDate>Tue, 01 Jul 2025 16:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<div id="notion-article" class="mx-auto overflow-hidden "><main class="notion light-mode notion-page notion-block-2247c0311dd6804ab694f259cff19044"><div class="notion-viewport"></div><div class="notion-collection-page-properties"></div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-2247c0311dd68048a39ccd37b89aab0b" data-id="2247c0311dd68048a39ccd37b89aab0b"><span><div id="2247c0311dd68048a39ccd37b89aab0b" class="notion-header-anchor"></div><a class="notion-hash-link" href="#2247c0311dd68048a39ccd37b89aab0b" title="漏洞分析"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">漏洞分析</span></span></h2><div class="notion-text notion-block-2247c0311dd680c98581f7991e683b75">漏洞入口位于：<code class="notion-inline-code">com.qiyuesuo.api.PdfVerifierController#verify()</code></div><div class="notion-text notion-block-2247c0311dd680d6ad0bd5670acf8afc">这里的<code class="notion-inline-code">verify</code>方法接收一个上传的文件对象，获取内容和文件类型后，传入<code class="notion-inline-code">doVerify</code></div><div class="notion-text notion-block-2247c0311dd680a19831e2dbaa051080">如果类型为ofd的话，即可调用<code class="notion-inline-code">gjzwOfdVerifyHandler.verify()</code></div><div class="notion-text notion-block-22c7c0311dd68044bab3ecbb8f5e532c">跟进<code class="notion-inline-code">isOfd()</code></div><div class="notion-text notion-block-2247c0311dd680af9e3fccec7585f27d">这里把上传的内容写到临时ofd文件中并解压，这里没有对压缩包内部的文件名做安全校验，导致Zipslip漏洞，可以上传任意文件。</div><div class="notion-text notion-block-2247c0311dd6805cba14f9233c970531">由于契约锁的安全补丁是热更新。根据这个机制，我们可以上传恶意jar包覆盖<code class="notion-inline-code">private-security-patch.jar</code></div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-2247c0311dd68077b7bbf917754f8351" data-id="2247c0311dd68077b7bbf917754f8351"><span><div id="2247c0311dd68077b7bbf917754f8351" class="notion-header-anchor"></div><a class="notion-hash-link" href="#2247c0311dd68077b7bbf917754f8351" title="漏洞复现"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">漏洞复现</span></span></h2><div class="notion-text notion-block-2247c0311dd6809cb247c535a0748af6">1.网站首页如下图：</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-2247c0311dd680ff9442f3bc15d88c60"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3A08d9c1ef-392e-4afb-8a24-aef6676c2ad5%3Aimage.png?table=block&amp;id=2247c031-1dd6-80ff-9442-f3bc15d88c60&amp;t=2247c031-1dd6-80ff-9442-f3bc15d88c60" alt="notion image" loading="lazy" decoding="async"/></div></figure><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-2257c0311dd6808b8088f8c38467e812"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3Af9cf4f9a-c89b-4d60-9d78-f9d2aec883c1%3A355af526b76860b4bc9616d64c8874f.png?table=block&amp;id=2257c031-1dd6-808b-8088-f8c38467e812&amp;t=2257c031-1dd6-808b-8088-f8c38467e812" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-23b7c0311dd68025b4a9fb5b6adc8dcd">在官网下载一个补丁包，然后在补丁jar的clas中插入恶意代码即可。</div><div class="notion-text notion-block-23b7c0311dd680588d27d51a15bf701f">或者按照<a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://mp.weixin.qq.com/s/u--mcFjhYly74q-Qg3D7jQ">https://mp.weixin.qq.com/s/u--mcFjhYly74q-Qg3D7jQ</a>提到的操作，制作一个<code class="notion-inline-code">com.qiyuesuo.security.patch.filter.logic.AAAA</code>的class拖入正常补丁jar包中</div><div class="notion-text notion-block-2257c0311dd68036adafed1b4186c095">使用以下脚本构造路径穿越的压缩包：</div><div class="notion-text notion-block-2247c0311dd6806bb914fa7b165c42ff">使用以下PoC上传zip，有的版本路径是/api/pdfverifier</div></main></div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[泛微ecology9 getdata.jsp 远程代码执行漏洞分析]]></title>
            <link>https://le1a.github.io/article/2157c031-1dd6-8045-9dbc-ef59b391bfe6</link>
            <guid>https://le1a.github.io/article/2157c031-1dd6-8045-9dbc-ef59b391bfe6</guid>
            <pubDate>Mon, 16 Jun 2025 16:00:00 GMT</pubDate>
            <description><![CDATA[该文章需要密码才能查看！]]></description>
            <content:encoded><![CDATA[该文章需要密码才能查看！]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[契约锁 dbtest JDBC 任意文件文件读取 & 远程代码执行漏洞]]></title>
            <link>https://le1a.github.io/article/20f7c031-1dd6-80e5-9c91-c325793a6c0e</link>
            <guid>https://le1a.github.io/article/20f7c031-1dd6-80e5-9c91-c325793a6c0e</guid>
            <pubDate>Tue, 10 Jun 2025 16:00:00 GMT</pubDate>
            <content:encoded><![CDATA[<div id="notion-article" class="mx-auto overflow-hidden "><main class="notion light-mode notion-page notion-block-20f7c0311dd680e59c91c325793a6c0e"><div class="notion-viewport"></div><div class="notion-collection-page-properties"></div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-20f7c0311dd680b0809dc4113749b619" data-id="20f7c0311dd680b0809dc4113749b619"><span><div id="20f7c0311dd680b0809dc4113749b619" class="notion-header-anchor"></div><a class="notion-hash-link" href="#20f7c0311dd680b0809dc4113749b619" title="漏洞原理"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">漏洞原理</span></span></h2><div class="notion-text notion-block-20f7c0311dd6805e8cf8d5cad86307fe">漏洞点位于：com.qiyuesuo.setup.SetupController#dbtest()</div><div class="notion-text notion-block-20f7c0311dd680e79159c0df59c06eec">这里默认采用Mysql驱动，获取各种参数后，构建出jdbcurl发起连接。经测试该接口是未授权的。</div><div class="notion-text notion-block-20f7c0311dd68085b1ecf4d002c44416">通过查看Database的枚举类型可知，可以选择如下驱动：</div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-20f7c0311dd6808b8e07de2070a8b01f" data-id="20f7c0311dd6808b8e07de2070a8b01f"><span><div id="20f7c0311dd6808b8e07de2070a8b01f" class="notion-header-anchor"></div><a class="notion-hash-link" href="#20f7c0311dd6808b8e07de2070a8b01f" title="漏洞复现"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">漏洞复现</span></span></h2><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-20f7c0311dd6800fa94ce94c154308ee" data-id="20f7c0311dd6800fa94ce94c154308ee"><span><div id="20f7c0311dd6800fa94ce94c154308ee" class="notion-header-anchor"></div><a class="notion-hash-link" href="#20f7c0311dd6800fa94ce94c154308ee" title="Mysql任意文件读取"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Mysql任意文件读取</span></span></h3><div class="notion-text notion-block-20f7c0311dd6800e8234df620726adda">启动一个恶意Mysql服务器，发送请求即可读取/etc/passwd文件</div><div class="notion-text notion-block-20f7c0311dd680229278dcc1e0b10a83"></div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-20f7c0311dd6802299ffdcfa4046992f"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3Aab219da3-cdac-43e2-9305-1b08dffac813%3Aimage.png?table=block&amp;id=20f7c031-1dd6-8022-99ff-dcfa4046992f&amp;t=20f7c031-1dd6-8022-99ff-dcfa4046992f" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-20f7c0311dd68074b22acadba7155c3e"></div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-20f7c0311dd68001aa61c0c819d25802"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3Ac53c9b96-9484-4199-9cb0-b112b5aed8d4%3Aimage.png?table=block&amp;id=20f7c031-1dd6-8001-aa61-c0c819d25802&amp;t=20f7c031-1dd6-8001-aa61-c0c819d25802" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-20f7c0311dd680319d82c39413007d2b"></div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-20f7c0311dd6802c9c0ffd6de7cb2bd5" data-id="20f7c0311dd6802c9c0ffd6de7cb2bd5"><span><div id="20f7c0311dd6802c9c0ffd6de7cb2bd5" class="notion-header-anchor"></div><a class="notion-hash-link" href="#20f7c0311dd6802c9c0ffd6de7cb2bd5" title="PostgreSQL RCE"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">PostgreSQL RCE</span></span></h3><div class="notion-text notion-block-20f7c0311dd680a4a566c8ad7046ba06">经过查看PostgreSQL的版本，发现是符合CVE-2022-21724的版本范围的</div><div class="notion-text notion-block-20f7c0311dd680b0b2dbd70eb63d7519">版本范围是：</div><div class="notion-text notion-block-20f7c0311dd680f19730c113a0e009d2">那么起一个HTTP服务，放置一个恶意的xml文件：</div><div class="notion-text notion-block-20f7c0311dd68088804ff782a94ff513">Database的枚举类型构造如下</div><div class="notion-text notion-block-20f7c0311dd680118619e3381f4a5d05">需要注意的是：</div><ul class="notion-list notion-list-disc notion-block-20f7c0311dd680728bb6f83e4ad7d2ac"><li>db的值必须是全大写的，否则会400状态码</li></ul><ul class="notion-list notion-list-disc notion-block-20f7c0311dd6808a8a4bc23381f06ee3"><li>POSTGRESQL会拼接port和dbname，所以需要在host末尾添加%26来截断</li></ul><div class="notion-text notion-block-20f7c0311dd68069b1f5f82d985ef0e1">使用如下PoC发起请求</div><div class="notion-text notion-block-20f7c0311dd6808297c2ee3a4a080c27"></div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-20f7c0311dd6809c9e16f4107066df72"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3A22652bc5-eeb0-421a-8fa0-6d53b68cd0d2%3Aimage.png?table=block&amp;id=20f7c031-1dd6-809c-9e16-f4107066df72&amp;t=20f7c031-1dd6-809c-9e16-f4107066df72" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-20f7c0311dd6805aaa13f4c97c85281f"></div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-20f7c0311dd68090a5b9c787c9462a7c"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3Acf3452e6-6637-4301-bc02-845e17243fd0%3Aimage.png?table=block&amp;id=20f7c031-1dd6-8090-a5b9-c787c9462a7c&amp;t=20f7c031-1dd6-8090-a5b9-c787c9462a7c" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-20f7c0311dd6800b8e75e30e8acedba1"></div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-20f7c0311dd6801cb1bdf4bfc5fa9a65"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/attachment%3Aaa4ec8b8-190a-4970-b24a-943002355930%3Aimage.png?table=block&amp;id=20f7c031-1dd6-801c-b1bd-f4bfc5fa9a65&amp;t=20f7c031-1dd6-801c-b1bd-f4bfc5fa9a65" alt="notion image" loading="lazy" decoding="async"/></div></figure></main></div>]]></content:encoded>
        </item>
    </channel>
</rss>